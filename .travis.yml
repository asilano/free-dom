language: ruby
cache: bundle
addons:
  chrome: stable
services:
- postgresql
before_install:
- gem update --system
- gem install bundler
- 
- google-chrome-stable --headless --disable-gpu --remote-debugging-port=9222 http://localhost
  &
install:
- wget -N http://chromedriver.storage.googleapis.com/2.30/chromedriver_linux64.zip
  -P ~/
- unzip ~/chromedriver_linux64.zip -d ~/
- rm ~/chromedriver_linux64.zip
- sudo mv -f ~/chromedriver /usr/local/share/
- sudo chmod +x /usr/local/share/chromedriver
- sudo ln -s /usr/local/share/chromedriver /usr/local/bin/chromedriver
- bundle install
before_script:
- psql -c 'create database travis_ci_test;' -U postgres
- cp config/database.yml.travis config/database.yml
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script: xvfb-run bin/rails spec
after_script:
- "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
env:
  global:
    secure: VPECYZrWzS43neyZWx/1ZSWE5yUhGnhS1pZQGS2B83/dvIII/H2nlB3Lbr36UYdI3rM+ZpQYyxUD6bxcfhxYd99fArvzVeYftB/GTV0KUQOYr9QDLyhrK/WJ1OhyAPPFDqlMot7Dd2RzUOdkEnuhkK3QGGtGfQ0SUkQ22AiqGdQ=
